# 資料庫定義值文件

## 其他值設定

### 📖 描述

設定主要所得及資金來源和 AML 職業別的「其他」代碼值，用於驗證申請書資料的完整性。設定來源為 `appsettings.json` 的 **ValidationSetting** 屬性。

### ✅ 資料庫定義值說明

| 設定項目                    | 說明                                                   | 範例                        |
| --------------------------- | ------------------------------------------------------ | --------------------------- |
| MainIncomeAndFundOther      | 主要所得及資金來源設定為「其他」的代碼                 | 9                           |
| AMLProfessionOther_XXXXXXXX | AML 職業別設定為「其他」的代碼，其中 XXXXXXXX 為版本號 | AMLProfessionOther_20250121 |

📌**重要提醒**：

- 每次更新 AML 職業類別版本時，都必須新增對應的設定值。版本號格式為 YYYYMMDD。

🔸 **設定範例**：

```json
"ValidationSetting": {
  "MainIncomeAndFundOther": "9",
  "AMLProfessionOther_20240101": "0",
  "AMLProfessionOther_20250121": "0",
  "AMLProfessionOther_20250723": "99"
}
```

### 🔍 驗證檢查涵蓋範圍

**ScoreSharp.API**

- UpdateApplicationInfoById (更改申請書資料)

**ScoreSharp.Middleware**

- ECardNewCase (網路進件)

**ScoreSharp.PaperMiddleware**

- SyncApplyInfoPaper (紙本建檔同步案件)

---

## AML 職業別版本管理設定

### 📖 描述

管理 AML 職業別版本的取得機制、設定作業規則，以及各種進件方式的版本押上與驗證流程。

### ✅ 資料庫定義值說明

| 設定項目                  | 說明                            | 範例     |
| ------------------------- | ------------------------------- | -------- |
| AMLProfessionCode_Version | 系統參數中的 AML 職業別版本設定 | 20250121 |

📌**重要提醒**：

- 刪除 AML 職業別時，系統會檢查該版本是否正在使用中。若版本正在使用中，則不允許刪除。

🔸 **設定範例**：

```json
{
  "AMLProfessionCode_Version": "20250121"
}
```

### 🔍 涵蓋範圍

**ScoreSharp.API**

H5 - 系統參數設定

- GetSysParamAll (取得所有系統參數)
- PutSysParamAllBySeqNo (更新系統參數)

A4 - 徵審通用

- GetReviewerAllOptions (取得徵審相關下拉選單 - 含依版本分類的 AML 職業別)

**ScoreSharp.Middleware**

網路件流程

- ECardNewCase (網路進件 - 版本押上與驗證)

**ScoreSharp.PaperMiddleware**

紙本件流程

- SyncApplyFile (圖檔傳送 - 版本押上)
- SyncApplyInfoPaper (紙本建檔同步案件 - 驗證)

---

## 派案經辦人員管理定義值設定

### 📖 描述

在 Reviewer_ApplyCreditCardInfoMain 表中管理派案時的經辦人員設定，包含前手經辦人員和目前經辦人員的追蹤與更新機制。

### ✅ 資料庫定義值說明

| 設定項目             | 說明                                                | 範例      |
| -------------------- | --------------------------------------------------- | --------- |
| PreviousHandleUserId | 前手經辦人員 ID，用於退回重審時設定為該案件轉交人員 | arthurlin |
| CurrentHandleUserId  | 目前經辦人員 ID，會隨著轉交而持續更新               | janehuang |

📌**重要提醒**

- 前手經辦人員於主管或系統進行派案時設定，主要用於退回重審流程
- 當前經辦人員會因轉交而持續更新，需確保資料一致性

🔸 **設定範例**：

```json
{
  "PreviousHandleUserId": "arthurlin",
  "CurrentHandleUserId": "janehuang"
}
```

### 🔍 驗證檢查涵蓋範圍

**徵審模組**

- BatchUpdateCurrentHandleUserId (派案時設定)
- ReturnInManualReviewByApplyNo (退回重審時設定)
- CompleteMonthlyIncomeByApplyNo (完成月收入確認時設定)
- CompleteCaseChangeByApplyNo (完成月收入確認案件異動時設定)
- CompleteManualReviewCaseChangeByApplyNo (完成人工徵審時設定)

---

## 經辦人員歷程追蹤定義值設定

### 📖 描述

在 Reviewer_ApplyCreditCardInfoHandle 表中記錄各階段最後經辦人員，用於追蹤月收入確認、審查及核卡等不同階段的負責人員。

### ✅ 資料庫定義值說明

| 設定項目                 | 說明                                    | 範例      |
| ------------------------ | --------------------------------------- | --------- |
| MonthlyIncomeCheckUserId | 月收入確認人員 ID，完成月收入預審時設定 | arthurlin |
| ReviewerUserId           | 審查人員 ID，人工徵信派案時設定         | janehuang |
| ApproveUserId            | 核准人員 ID，在核卡、退件、撤件時設定   | linachen  |
| SupplementUserId         | 補件人員 ID，補件時設定                 | arthurlin |

📌**重要提醒**

- 月收入確認人員會保持一致，不會因轉派而改變
- 審查人員目前都會一致，重新派案時需考慮是否更新此欄位
- 核卡人員可能因轉派或核卡額度不足而有不同人員
- 補件人員會因為客人補回件而清除此欄位
- TODO: 調撥案件也需要設定 ReviewerUserId

🔸 **設定範例**：

```json
{
  "MonthlyIncomeCheckUserId": "arthurlin",
  "ReviewerUserId": "janehuang",
  "ApproveUserId": "linachen",
  "SupplementUserId": "arthurlin"
}
```

### 🔍 驗證檢查涵蓋範圍

**ScoreSharp.API**

- ReviewerUserId + ReviewerTime

  - BatchUpdateCurrentHandleUserId

- MonthlyIncomeCheckUserId + MonthlyIncomeTime

  - CompleteMonthlyIncomeByApplyNo

- ApproveUserId + ApproveTime

  - CompleteManualReviewCaseChangeByApplyNo

  - CompleteCaseChangeByApplyNo

- SupplementUserId + SupplementTime

  - CompleteManualReviewCaseChangeWithTransferInByApplyNo

  - CompleteCaseChangeByApplyNo

**ScoreSharp.Middleware**

- SupplementUserId + SupplementTime

  - EcardMyDataSuccess
  - EcardMyDataFail

**ScoreSharp.Batch**

- ReviewerUserId + ReviewerTime

  - SystemAssignment

---

## 最後更新人員追蹤定義值設定

### 📖 描述

追蹤各個狀態更改時的最後操作人員，確保系統能記錄每次狀態變更的責任歸屬。

### ✅ 資料庫定義值說明

| 設定項目         | 說明                                  | 範例 |
| ---------------- | ------------------------------------- | ---- |
| LastUpdateUserId | 最後更新使用者 ID，應在更改狀態時押上 | U006 |

📌**重要提醒**

- 應在所有狀態更改時押上最後使用者 ID

🔸 **設定範例**：

```json
{
  "LastUpdateUserId": "U006"
}
```

### 🔍 驗證檢查涵蓋範圍

**ScoreSharp.API**

- UpdateManualReviewCaseChangeWithTransferInByApplyNo (更新人工徵審案件異動\_權限內)
- UpdateManualReviewCaseChangeWithTransferOutByApplyNo (更新人工徵審案件異動\_權限外)
- ReturnInManualReviewByApplyNo (退回人工徵審)
- CompleteManualReviewCaseChangeWithTransferInByApplyNo (完成人工徵審案件異動\_權限內)
- CompleteManualReviewCaseChangeWithTransferOutByApplyNo (完成人工徵審案件異動\_權限外)
- UpdateCaseChangeByApplyNo (更新案件異動)
- UpdateMonthlyIncomeInfoByApplyNo (更新月收入資訊)
- CompleteCaseChangeByApplyNo (完成案件異動)
- CompleteMonthlyIncomeByApplyNo (完成月收入簽核資料)

**ScoreSharp.Middleware**

- EcardSupplement (補件入檔)
- EcardMyDataSuccess (取件成功入檔)
- EcardNewCase (網路進件)
- EcardMyDataFail (取件失敗入檔)
- EcardSupplementMyDataFail (補件 MYDATA 失敗入檔)

**ScoreSharp.PaperMiddleware**

- SyncApplyInfoPaper (紙本建檔同步案件)
- SyncApplyFile (圖檔傳送)
- SyncApplyInfoWebWhite (網路小白件同步案件)

**ScoreSharp.Batch**

- KYCSyncJob (KYC 同步作業)
- EcardA02CheckNewCase (網路檢核原卡友案件)
- EcardNotA02CheckNewCase (網路檢核非卡友案件)
- GuoLuKaCheck (國旅卡檢核作業)
- PaperCheckNewCase (紙本檢核案件)

---

## 徵信代碼管理定義值設定

### 📖 描述

徵信代碼用於核卡時的判斷依據，確保所有核卡案件的徵信代碼保持一致性。

### ✅ 資料庫定義值說明

| 設定項目        | 說明                           | 範例 |
| --------------- | ------------------------------ | ---- |
| CreditCheckCode | 徵信代碼，用於核卡時的判斷標準 | A06  |

📌**重要提醒**

- 所有核卡的徵信代碼皆需要一致
- 只有核卡作業或排入核卡時，徵信代碼才會有值且需要一致
- 必須確保同一案件在不同階段的徵信代碼保持統一

🔸 **設定範例**：

```json
{
  "CreditCheckCode": "A06"
}
```

### 🔍 驗證檢查涵蓋範圍

**徵審模組**

- UpdateMonthlyIncomeInfoByApplyNo (更新月收入資訊時設定)
- UpdateManualReviewCaseChangeByApplyNo (更新人工徵審案件異動時設定)
